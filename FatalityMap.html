<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Crash Mapper</title>
    <!-- Stylesheets -->
    <link rel="stylesheet" href="leaflet/leaflet.css" />
    <link rel="stylesheet" href="pure-drawer.css" />
    <link rel="stylesheet" href="toggle-button.css" />
    <link rel="stylesheet" href="myStyle.css" />
    <!-- Scripts -->
    <script src="leaflet/leaflet.js"></script>
    <script src="FARS_Data_FranklinCounty_AllVariables_2016.js"></script>
    <!-- <script src="FARS_Ohio_2001-2016.js"></script> -->
    <script src="d3/d3.min.js"></script>
    <script src="plotly-latest.min.js"></script>
    <script src="heatmap.js"></script>
    <script src="leaflet-heatmap.js"></script>
    <script src="heatmap-data.js"></script>
    <script src="main.js"></script>
</head>

<body>
    <div class="pure-container" data-effect="pure-effect-slide">
        <input type="checkbox" id="pure-toggle-right" class="pure-toggle" data-toggle="right" />
        <label class="pure-toggle-label" for="pure-toggle-right" data-toggle-label="right">
            <span class="pure-toggle-icon"></span>
        </label>

        <nav class="pure-drawer" data-position="right">
            <p style="padding: 0 0; margin: 0;">


                <div id="sidebarFrame">
                    <div id="sidebarContent">
                        
                        <div id="heatmapToggle" state=0>
                            <div class="cntr">
                                <span>
                                    <a>Toggle Heatmap</a>
                                    <div class="row press">
                                        <input type="checkbox" id="unchecked" class="cbx hidden" />
                                        <label for="unchecked" class="lbl"></label>
                                        <script>
                                            var button = document.getElementById("heatmapToggle");
                                            button.onclick = function() {
                                                if (button.getAttribute("state") == 0){
                                                    button.setAttribute("state", 1);
                                                }
                                                
                                            };
                                        </script>
                                    </div>
                                </span>
                            </div>
                        </div>
                        <div id="sidebarList">
                            Fatality Information
                            <ul>Location</ul>
                            <ul>Age</ul>
                            <ul>Victim Count</ul>
                        </div>
                    </div>
                </div>
                <div id="pcpFrame"></div>
                <script>
                    // https://raw.githubusercontent.com/bcdunbar/datasets/master/iris.csv
                    // data/FARS_Data_FranklinCounty_2016_AllVariables.csv
                    // data/FARS_Ohio_2001-2016.csv
                    Plotly.d3.csv('data/FARS_Data_FranklinCounty_2016_AllVariables.csv', function (err, rows) {

                        function unpack(rows, key) {
                            return rows.map(function (row) {
                                return row[key];
                            });
                        }

                        var data = [{
                            type: 'parcoords',
                            //pad: [80, 80, 80, 80],
                            line: {
                                color: unpack(rows, 'sex'),
                                //colorscale: [[0, 'grey'], [1, 'blue'], [2, 'pink'], [8, 'grey'], [9, 'grey']]
                                colorscale: [[0, 'blue'], [0.5, 'blue'], [1, 'red']]
                                //colorscale: 'Jet'
                            },

                            dimensions: [{
                                range: [1, 2],
                                label: 'sex (m=1,f=2)',
                                values: unpack(rows, 'sex')
                            }, {
                                range: [0, 99],
                                label: 'age',
                                values: unpack(rows, 'age')
                            }, {
                                //constraintrange: [0, 99],
                                range: [0, 4],
                                label: 'numfatal',
                                values: unpack(rows, 'numfatal')
                            }, {
                                label: 'BAC',
                                range: [0, 500],
                                values: unpack(rows, 'alcres')
                            }, {
                                label: 'day of week',
                                range: [1, 7],
                                values: unpack(rows, 'dayofweek')
                            }]
                        }];

                        var layout = {
                            // put variables here to change pcp size ('height: 500px;' etc)
                        };

                        Plotly.plot('pcpFrame', data, layout);
                    });
                </script>


            </p>
        </nav>

        <div class="pure-pusher-container">
            <div class="pure-pusher">
                <p style="width: 100%; height: 100%; margin: 0;">
                    <div id="mapDivId"></div>
                </p>
            </div>
        </div>

        <label class="pure-overlay" for="pure-toggle-right" data-overlay="left"></label>
    </div>
</body>

</html>